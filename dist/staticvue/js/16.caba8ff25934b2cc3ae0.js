webpackJsonp([16],{"1Imb":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("aA9S"),l=a.n(i),o=a("0tg7"),s=a("P9l9"),n={data:function(){return{folder_capacity:{},sels:[],total:0,page:1,page_size:10,listLoading:!1,listTables:[],filters:{search:""},blobUrl:"",folder_id_error:"",folder_fullpath:[],moveFormVisible:!1,moveFormLoading:!1,moveFormRules:{to_folder_id:[{required:!0,message:"",trigger:"blur"}]},moveForm:{folder_id:-1,save_list:[]}}},computed:{plang:function(){var e=o.a.zh;return e="zh-hans"==this.$store.getters.getLanguage?o.a.zh:"zh-tw"==this.$store.getters.getLanguage?o.a.zh_tw:"en"==this.$store.getters.getLanguage?o.a.en:(this.$store.getters.getLanguage,o.a.zh),this.moveFormRules={to_folder_id:[{required:!0,message:e.FILE_A_RULE,trigger:"blur"}]},e}},filters:{validateLeft_zh:function(e){var t=1e3*e,a=t/1e3/60/60/24,i=Math.floor(a),l=t/1e3/60/60-24*i,o=Math.floor(l),s=t/1e3/60-1440*i-60*o,n=Math.floor(s),r="";return i&&(r+=i+"天 "),o&&(r+=o+"时 "),n&&(r+=n+"分 "),i||o?i>30||30==i&&(o>0||n>0)?"永久":r:"即将过期"},validateLeft_zh_tw:function(e){var t=1e3*e,a=t/1e3/60/60/24,i=Math.floor(a),l=t/1e3/60/60-24*i,o=Math.floor(l),s=t/1e3/60-1440*i-60*o,n=Math.floor(s),r="";return i&&(r+=i+"天 "),o&&(r+=o+"时 "),n&&(r+=n+"分 "),i||o?i>30||30==i&&(o>0||n>0)?"永久":r:"即将过期"},validateLeft_en:function(e){var t=1e3*e,a=t/1e3/60/60/24,i=Math.floor(a),l=t/1e3/60/60-24*i,o=Math.floor(l),s=t/1e3/60-1440*i-60*o,n=Math.floor(s),r="";return i&&(r+=i+" day(s) "),o&&(r+=o+" hour(s) "),n&&(r+=n+" minute(s) "),i||o?i>30||30==i&&(o>0||n>0)?"forever":r:"will expired"}},created:function(){this.getTables()},methods:{getCapacity:function(){var e=this;Object(s._86)().then(function(t){"0%"==t.data.capacity&&(t.data.capacity=0),t.data.capacity>100&&(t.data.capacity=100),t.data.capacity<0&&(t.data.capacity=0),e.folder_capacity=t.data})},f_TableSelsChange:function(e){this.sels=e},f_TableSizeChange:function(e){this.page_size=e,this.getTables()},f_TableCurrentChange:function(e){this.page=e,this.getTables()},getTables:function(){var e=this;this.listLoading=!0;var t={limit:this.page_size,offset:(this.page-1)*this.page_size,search:this.filters.search};Object(s._30)(t).then(function(t){e.total=t.data.count,e.listTables=t.data.results;for(var a=0;a<e.listTables.length;a++){var i=e.listTables[a],l=i.filename.lastIndexOf("."),o="bf"+i.filename.slice(l+1).toUpperCase();i.classObject={},i.classObject[o]=!0}e.listLoading=!1}).catch(function(){e.listLoading=!1}),this.getCapacity()},deleteFiles:function(){var e=this,t=this,a=this.sels.map(function(e){return e.id});this.$confirm(this.plang.FILE_A_MSG1,this.plang.COMMON_BUTTON_CONFIRM_NOTICE,{type:"warning"}).then(function(){e.listLoading=!0;var i={ids:a};Object(s._67)(i).then(function(i){e.listLoading=!1,t.$message({message:e.plang.COMMON_DELETE_SUCCESS,type:"success"}),(e.page-1)*e.page_size>=e.total-a.length&&(e.page=1),e.getTables()}).catch(function(t){e.listLoading=!1,console.log(t)})}).catch(function(){})},deleteRowFiles:function(e){var t=this,a=this;this.$confirm(this.plang.FILE_A_MSG2,this.plang.COMMON_BUTTON_CONFIRM_NOTICE,{type:"warning"}).then(function(){t.listLoading=!0;var i={ids:[e.id]};Object(s._67)(i).then(function(e){t.listLoading=!1,a.$message({message:t.plang.COMMON_DELETE_SUCCESS,type:"success"}),(t.page-1)*t.page_size>=t.total-1&&(t.page=1),t.getTables()}).catch(function(e){t.listLoading=!1,console.log(e)})}).catch(function(){})},renewalRowFile:function(e){var t=this,a=this;this.listLoading=!0,Object(s.a)(e.id).then(function(e){t.listLoading=!1,a.$message({message:t.plang.FILE_A_MSG3,type:"success"}),t.getTables()}).catch(function(e){t.listLoading=!1,console.log(e),t.getTables()})},download:function(){this.$refs.download.click()},zipRowDownload:function(e){var t=this,a=this;this.listLoading=!0,Object(s._14)(e.id,{download:!0}).then(function(i){t.listLoading=!1;var l=new Blob([i.data],{type:i.headers["content-type"]}),o=URL.createObjectURL(l);t.blobUrl=o;var s=e.filename;if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(l,s);else{var n=document.createElement("a");n.setAttribute("href",o),n.setAttribute("download",s),document.body.appendChild(n),n.click()}a.$message({message:t.plang.COMMON_EXPORT_SUCCESS,type:"success"})}).catch(function(e){t.listLoading=!1,console.log(e)})},zipDownload:function(){var e=this,t=this;this.listLoading=!0;var a=this.sels.map(function(e){return e.id});Object(s._16)({ids:a}).then(function(a){e.listLoading=!1;var i=new Blob([a.data],{type:a.headers["content-type"]}),l=URL.createObjectURL(i);e.blobUrl=l;if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(i,"attachment.zip");else{var o=document.createElement("a");o.setAttribute("href",l),o.setAttribute("download","attachment.zip"),document.body.appendChild(o),o.click()}t.$message({message:e.plang.COMMON_EXPORT_SUCCESS,type:"success"})}).catch(function(t){e.listLoading=!1,console.log(t)})},moveFormShow:function(){var e=this;this.folder_id_error="",Object(s._93)().then(function(t){e.folder_fullpath=t.data;var a=e.moveForm;a.save_list=e.sels.map(function(e){return e.id}),e.moveForm=l()({},a),e.moveFormVisible=!0,e.moveFormLoading=!1})},moveFormShow2:function(e){var t=this;this.folder_id_error="",Object(s._93)().then(function(a){t.folder_fullpath=a.data;var i=t.moveForm;i.save_list=[e.id],t.moveForm=l()({},i),t.moveFormVisible=!0,t.moveFormLoading=!1})},moveFormSubmit:function(){var e=this;this.folder_id_error="",this.$refs.moveForm.validate(function(t){if(t){e.moveFormLoading=!0;var a=l()({},e.moveForm);Object(s._81)(a).then(function(t){e.$refs.moveForm.resetFields(),e.moveFormLoading=!1,e.moveFormVisible=!1,e.$message({message:e.plang.COMMON_SUBMIT_SUCCESS,type:"success"}),e.getTables()}).catch(function(t){e.moveFormLoading=!1,"non_field_errors"in t&&(e.folder_id_error=t.non_field_errors[0]),console.log(t)})}})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"j-module-content j-maillist mllist-list height100 "},[a("section",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"content content-list height100",staticStyle:{"background-color":"#fff",background:"rgba(255,255,255,0.8)"}},[a("el-form",{staticStyle:{padding:"4px 0 4px 4px"},attrs:{inline:!0,model:e.filters}},[a("el-row",[a("el-col",{staticStyle:{"text-align":"left"}},[a("el-form-item",{staticStyle:{"margin-bottom":"0px!important"}},[a("el-button",{attrs:{plain:"",size:"small",type:"primary",icon:"el-icon-download",disabled:0===this.sels.length},on:{click:e.zipDownload}},[e._v(e._s(e.plang.FILE_P_DOWNLOAD))]),e._v(" "),a("el-button",{attrs:{plain:"",size:"small",type:"primary",icon:"el-icon-message",disabled:0===this.sels.length},on:{click:function(t){e.$parent.sendMail_net("more",e.sels)}}},[e._v(e._s(e.plang.FILE_P_SEND))]),e._v(" "),a("el-button",{attrs:{plain:"",size:"small",type:"primary",disabled:0===this.sels.length},on:{click:e.moveFormShow}},[e._v(e._s(e.plang.FILE_A_TOP))]),e._v(" "),a("el-button",{attrs:{plain:"",size:"small",type:"danger",icon:"el-icon-delete",disabled:0===this.sels.length},on:{click:e.deleteFiles}},[e._v(e._s(e.plang.COMMON_BUTTON_DELETE))])],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"0px!important"}},[a("el-input",{attrs:{placeholder:e.plang.FILE_A_SEARCH,size:"small",tyle:"width:auto;"},model:{value:e.filters.search,callback:function(t){e.$set(e.filters,"search","string"==typeof t?t.trim():t)},expression:"filters.search"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},on:{click:e.getTables},slot:"suffix"})])],1),e._v(" "),a("a",{ref:"download",staticStyle:{display:"none"},attrs:{href:e.blobUrl,download:""}})],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticStyle:{padding:"10px 0 10px 14px"}},[a("b",[e._v(e._s(e.plang.FILE_INDEX_A))]),e._v(" "),a("span",{staticStyle:{"font-size":"12px",color:"#bbb","margin-left":"20px"}},[e._v(" "+e._s(e.plang.FILE_P_CAP))]),e._v(" "),a("el-progress",{staticStyle:{width:"200px",display:"inline-block"},attrs:{percentage:e.folder_capacity.capacity}}),e._v(" "),a("span",{staticStyle:{"font-size":"12px",color:"#409eff","margin-left":"-49px"}},[e._v(" "+e._s(e.folder_capacity.used)+" / "+e._s(e.folder_capacity.total))])],1)]),e._v(" "),e.total>0?a("el-col",{staticStyle:{"text-align":"right","margin-top":"6px","line-height":"28px"},attrs:{span:12}},[e.total>0?a("el-pagination",{staticStyle:{display:"inline-block"},attrs:{"current-page":e.page,"page-sizes":[10,20,50],"page-size":e.page_size,total:e.total,layout:"total, sizes, prev"},on:{"size-change":e.f_TableSizeChange,"current-change":e.f_TableCurrentChange}}):e._e(),e._v(" "),a("span",[e._v(e._s(this.page+" / "+Math.ceil(this.total/this.page_size)))]),e._v(" "),e.total>0?a("el-pagination",{staticStyle:{display:"inline-block"},attrs:{"current-page":e.page,"page-sizes":[10,20,50],"page-size":e.page_size,total:e.total,layout:" next,jumper"},on:{"size-change":e.f_TableSizeChange,"current-change":e.f_TableCurrentChange}}):e._e()],1):e._e()],1)],1),e._v(" "),a("el-row",[a("el-table",{staticStyle:{width:"100%","max-width":"100%",height:"100%"},attrs:{data:e.listTables,"tooltip-effect":"dark","header-cell-style":{background:"#f0f1f3"},size:"mini"},on:{"selection-change":e.f_TableSelsChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:e.plang.COMMON_NAME},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",[a("el-col",{staticStyle:{width:"42px","padding-top":"8px"},attrs:{span:1}},[a("span",{staticClass:"bico",class:t.row.classObject})]),e._v(" "),a("el-col",{staticStyle:{"font-size":"16px"},attrs:{span:20}},[a("div",{staticStyle:{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:t.row.filename}},[e._v(e._s(t.row.filename))]),e._v(" "),a("div",{staticClass:"actions_a"},[a("span",{on:{click:function(a){e.zipRowDownload(t.row)}}},[e._v(e._s(e.plang.FILE_P_DOWNLOAD))]),e._v(" "),a("span",{on:{click:function(a){e.$parent.sendMail_net(t.row)}}},[e._v(e._s(e.plang.FILE_P_SEND2))]),e._v(" "),a("span",{on:{click:function(a){e.moveFormShow2(t.row)}}},[e._v(e._s(e.plang.FILE_A_TOP))]),e._v(" "),a("span",{on:{click:function(a){e.renewalRowFile(t.row)}}},[e._v(e._s(e.plang.FILE_A_XUQI))]),e._v(" "),/.(gif|jpg|jpeg|png|bmp|svg|pdf|html|txt|xls|xlsx|doc|docx|ppt|pptx|xml|csv|md|log)$/.test(t.row.filename.toLowerCase())?a("span",{on:{click:function(a){e.$parent.preview(t.row,"mail")}}},[e._v(e._s(e.plang.COMMON_BUTTON_PREVIEW))]):e._e(),e._v(" "),a("span",{staticStyle:{color:"#f56c6c"},on:{click:function(a){e.deleteRowFiles(t.row)}}},[e._v(e._s(e.plang.COMMON_BUTTON_DELETE))])])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.plang.COMMON_SIZE,width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("mailsize")(t.row.size)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.plang.FILE_P_TIME,width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-time"}),e._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.created.replace("T"," ")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.plang.FILE_A_TIME,width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return["zh-hans"==e.$store.getters.getLanguage?a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("validateLeft_zh")(t.row.left_timestamp)))]):e._e(),e._v(" "),"zh-tw"==e.$store.getters.getLanguage?a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("validateLeft_zh_tw")(t.row.left_timestamp)))]):e._e(),e._v(" "),"en"==e.$store.getters.getLanguage?a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e._f("validateLeft_en")(t.row.left_timestamp)))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.plang.COMMON_MAIL_SUBJECT},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"nowrap",attrs:{title:t.row.subject}},[e._v(e._s(t.row.subject))])]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.plang.FILE_A_TOP,visible:e.moveFormVisible,"close-on-click-modal":!1,"append-to-body":!0},on:{"update:visible":function(t){e.moveFormVisible=t}}},[a("el-form",{ref:"moveForm",attrs:{model:e.moveForm,"label-width":"130px",rules:e.moveFormRules}},[a("el-form-item",{attrs:{label:e.plang.FILE_A_PATH,prop:"folder_id",error:e.folder_id_error}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.plang.FILE_A_PATH_PLACE},model:{value:e.moveForm.folder_id,callback:function(t){e.$set(e.moveForm,"folder_id",t)},expression:"moveForm.folder_id"}},e._l(e.folder_fullpath,function(e){return a("el-option",{key:e.id,attrs:{label:e.full_path,value:e.id}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.moveFormVisible=!1}}},[e._v(e._s(e.plang.COMMON_BUTTON_CANCELL))]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.moveFormLoading},nativeOn:{click:function(t){e.moveFormSubmit()}}},[e._v(e._s(e.plang.COMMON_BUTTON_SUBMIT))])],1)],1)],1)])},staticRenderFns:[]};var c=a("C7Lr")(n,r,!1,function(e){a("rhCH")},null,null);t.default=c.exports},rhCH:function(e,t){}});
//# sourceMappingURL=16.caba8ff25934b2cc3ae0.js.map